var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},__extends=function(t,e){function r(){this.constructor=t}extendStatics(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},__assign=Object.assign||function(t){for(var e,r=1,n=arguments.length;n>r;r++){e=arguments[r];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},__rest=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(r[n[o]]=t[n[o]]);return r},__decorate=function(t,e,r,n){var o,i=arguments.length,a=3>i?e:null===n?n=Object.getOwnPropertyDescriptor(e,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,r,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(a=(3>i?o(a):i>3?o(e,r,a):o(e,r))||a);return i>3&&a&&Object.defineProperty(e,r,a),a},__param=function(t,e){return function(r,n){e(r,n,t)}},__metadata=function(t,e){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(t,e):void 0},__awaiter=function(t,e,r,n){function o(t){return t instanceof r?t:new r(function(e){e(t)})}return new(r||(r=Promise))(function(r,i){function a(t){try{c(n.next(t))}catch(e){i(e)}}function s(t){try{c(n["throw"](t))}catch(e){i(e)}}function c(t){t.done?r(t.value):o(t.value).then(a,s)}c((n=n.apply(t,e||[])).next())})},__generator=function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=2&r[0]?i["return"]:r[0]?i["throw"]||((a=i["return"])&&a.call(i),0):i.next)&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[2&r[0],a.value]),r[0]){case 0:case 1:a=r;break;case 4:return c.label++,{value:r[1],done:!1};case 5:c.label++,i=r[1],r=[0];continue;case 7:r=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){c=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){c.label=r[1];break}if(6===r[0]&&c.label<a[1]){c.label=a[1],a=r;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(r);break}a[2]&&c.ops.pop(),c.trys.pop();continue}r=e.call(t,c)}catch(n){r=[6,n],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:r(0),"throw":r(1),"return":r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s},__exportStar=function(t,e){for(var r in t)"default"===r||e.hasOwnProperty(r)||__createBinding(e,t,r)},__createBinding=Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]},__values=function(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,o,i=r.call(t),a=[];try{for(;(void 0===e||e-->0)&&!(n=i.next()).done;)a.push(n.value)}catch(s){o={error:s}}finally{try{n&&!n.done&&(r=i["return"])&&r.call(i)}finally{if(o)throw o.error}}return a},__spread=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(__read(arguments[e]));return t},__spreadArrays=function(){for(var t=0,e=0,r=arguments.length;r>e;e++)t+=arguments[e].length;for(var n=Array(t),o=0,e=0;r>e;e++)for(var i=arguments[e],a=0,s=i.length;s>a;a++,o++)n[o]=i[a];return n},__await=function(t){return this instanceof __await?(this.v=t,this):new __await(t)},__asyncGenerator=function(t,e,r){function n(t){l[t]&&(u[t]=function(e){return new Promise(function(r,n){h.push([t,e,r,n])>1||o(t,e)})})}function o(t,e){try{i(l[t](e))}catch(r){c(h[0][3],r)}}function i(t){t.value instanceof __await?Promise.resolve(t.value.v).then(a,s):c(h[0][2],t)}function a(t){o("next",t)}function s(t){o("throw",t)}function c(t,e){t(e),h.shift(),h.length&&o(h[0][0],h[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var u,l=r.apply(t,e||[]),h=[];return u={},n("next"),n("throw"),n("return"),u[Symbol.asyncIterator]=function(){return this},u},__asyncDelegator=function(t){function e(e,o){r[e]=t[e]?function(r){return(n=!n)?{value:__await(t[e](r)),done:"return"===e}:o?o(r):r}:o}var r,n;return r={},e("next"),e("throw",function(t){throw t}),e("return"),r[Symbol.iterator]=function(){return this},r},__asyncValues=function(t){function e(e){n[e]=t[e]&&function(n){return new Promise(function(o,i){n=t[e](n),r(o,i,n.done,n.value)})}}function r(t,e,r,n){Promise.resolve(n).then(function(e){t({value:e,done:r})},e)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=t[Symbol.asyncIterator];return o?o.call(t):(t="function"==typeof __values?__values(t):t[Symbol.iterator](),n={},e("next"),e("throw"),e("return"),n[Symbol.asyncIterator]=function(){return this},n)},__makeTemplateObject=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__setModuleDefault=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t["default"]=e},__importStar=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&__createBinding(e,t,r);return __setModuleDefault(e,t),e},__importDefault=function(t){return t&&t.__esModule?t:{"default":t}},__classPrivateFieldGet=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r},__reflect=function(t,e,r){t.__class__=e,r?r.push(e):r=[e],t.__types__=t.__types__?r.concat(t.__types__):r};!function(t){function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var r={};return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(e){return t[e]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,r){r(1),r(2),r(3),r(4),r(5),r(6);var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(r){switch(r.label){case 0:return[4,this.loadResource()];case 1:return r.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return t=r.sent(),this.startAnimation(t),[4,platform.login()];case 3:return r.sent(),[4,platform.getUserInfo()];case 4:return e=r.sent(),console.log(e),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return r.sent(),[4,this.loadTheme()];case 2:return r.sent(),[4,RES.loadGroup("preload",0,t)];case 3:return r.sent(),this.stage.removeChild(t),[3,5];case 4:return e=r.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,r){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){this.addChild(new SceneBegin)},e.prototype.createBitmapByName=function(t){var e=new egret.Bitmap,r=RES.getRes(t);return e.texture=r,e},e.prototype.startAnimation=function(t){var e=this,r=new egret.HtmlTextParser,n=t.map(function(t){return r.parse(t)}),o=this.textfield,i=-1,a=function(){i++,i>=n.length&&(i=0);var t=n[i];o.textFlow=t;var r=egret.Tween.get(o);r.to({alpha:1},200),r.wait(2e3),r.to({alpha:0},200),r.call(a,e)};a()},e.prototype.onButtonClick=function(t){var e=new eui.Panel;e.title="Title",e.horizontalCenter=0,e.verticalCenter=0,this.addChild(e)},e}(eui.UILayer);window.Main=n,__reflect(n.prototype,"Main",[])},function(t,e){var r=function(){function t(){}return t.prototype.getAsset=function(t,e,r){function n(n){e.call(r,n,t)}if(RES.hasRes(t)){var o=RES.getRes(t);o?n(o):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();window.AssetAdapter=r,__reflect(r.prototype,"AssetAdapter",["eui.IAssetAdapter"])},function(t,e){var r=function(t){function e(){var e=t.call(this)||this;return e.createView(),e}return __extends(e,t),e.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},e.prototype.onProgress=function(t,e){this.textField.text="Loading..."+t+"/"+e},e}(egret.Sprite);window.LoadingUI=r,__reflect(r.prototype,"LoadingUI",["RES.PromiseTaskReporter"])},function(t,e){var r=function(){function t(){}return t.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();window.DebugPlatform=r,__reflect(r.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new r)},function(t,e){var r=function(){function t(){}return t.prototype.getTheme=function(t,e,r,n){function o(t){e.call(n,t)}function i(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),r.call(n))}var a=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,r){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},a)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var s=t.split("/");s.pop();var c=s.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(c,function(r){window.JSONParseClass.setData(r),egret.callLater(function(){e.call(n,generateJSON.paths[t])},a)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,i,null),RES.getResByUrl(t,o,this,RES.ResourceItem.TYPE_TEXT)},t}();window.ThemeAdapter=r,__reflect(r.prototype,"ThemeAdapter",["eui.IThemeAdapter"])},function(t,e){var r=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.partAdded=function(e,r){t.prototype.partAdded.call(this,e,r)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){this.beginBtn.once(egret.TouchEvent.TOUCH_TAP,this.start,this)},e.prototype.start=function(){this.parent.addChild(new SceneGame),this.parent.removeChild(this)},e}(eui.Component);window.SceneBegin=r,__reflect(r.prototype,"SceneBegin",["eui.UIComponent"])},function(t,e){var r=function(t){function e(){var e=t.call(this)||this;return e.blockSourceNames=[],e.blockArr=[],e.direction=1,e.minDistance=220,e.maxDistance=320,e.tanAngle=.556047197640118,e.jumpDistance=0,e.isReadyJump=!1,e.leftOrigin={x:180,y:350},e.rightOrigin={x:505,y:350},e.score=0,e.time=0,e}return __extends(e,t),e.prototype.partAdded=function(e,r){t.prototype.partAdded.call(this,e,r)},e.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this),this.init()},e.prototype.init=function(){this.blockSourceNames=["block1_png","block2_png","block3_png"],this.pushVoice=RES.getRes("push_mp3"),this.jumpVoice=RES.getRes("jump_mp3"),this.initBlock(),this.blockGroup.touchEnabled=!0,this.blockGroup.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTapBegin,this),this.blockGroup.addEventListener(egret.TouchEvent.TOUCH_END,this.onTapEnd,this),egret.startTick(this.computeDistance,this)},e.prototype.computeDistance=function(t){var e=t,r=this.time,n=e-r;return n/=1e3,this.isReadyJump&&(this.jumpDistance+=300*n),this.time=e,!0},e.prototype.onTapBegin=function(){this.pushSoundChannel=this.pushVoice.play(0,1),egret.Tween.get(this.player).to({scaleY:.5},3e3),this.isReadyJump=!0},e.prototype.onTapEnd=function(){var t=this;this.isReadyJump&&(this.targetPos||(this.targetPos=new egret.Point),this.blockGroup.touchEnabled=!1,this.pushSoundChannel.stop(),this.jumpVoice.play(0,1),egret.Tween.removeAllTweens(),this.isReadyJump=!1,this.targetPos.x=this.player.x+this.direction*this.jumpDistance,this.targetPos.y=this.player.y+this.direction*this.jumpDistance*(this.currentBlock.y-this.player.y)/(this.currentBlock.x-this.player.x),egret.Tween.get(this).to({factor:1},400).call(function(){t.player.scaleY=1,t.jumpDistance=0,t.checkResult()}),this.player.anchorOffsetY=this.player.height/2,egret.Tween.get(this.player).to({rotation:this.direction>0?360:-360},200).call(function(){t.player.rotation=0}).call(function(){t.player.anchorOffsetY=t.player.height-20}))},Object.defineProperty(e.prototype,"factor",{get:function(){return 0},set:function(t){this.player.x=(1-t)*(1-t)*this.player.x+2*t*(1-t)*(this.player.x+this.targetPos.x)/2+t*t*this.targetPos.x,this.player.y=(1-t)*(1-t)*this.player.y+2*t*(1-t)*(this.targetPos.y-300)+t*t*this.targetPos.y},enumerable:!1,configurable:!0}),e.prototype.initBlock=function(){this.currentBlock=this.createBlock(),this.currentBlock.x=this.leftOrigin.x,this.currentBlock.y=this.stage.stageHeight-this.leftOrigin.y,this.blockGroup.addChild(this.currentBlock),this.player.x=this.currentBlock.x,this.player.y=this.currentBlock.y,this.player.anchorOffsetX=this.player.width/2,this.player.anchorOffsetY=this.player.height-20,this.blockGroup.addChild(this.player),this.score=0,this.scoreLab.text=this.score.toString(),this.blockGroup.addChild(this.scoreLab),this.direction=1,this.addBlock()},e.prototype.checkResult=function(){var t=this,e=Math.pow(this.player.x-this.currentBlock.x,2)+Math.pow(this.player.y-this.currentBlock.y,2),r=8100;if(r>=e){this.score++,this.scoreLab.text=this.score.toString(),this.direction=Math.random()>.5?1:-1;var n=void 0,o=void 0;n=this.direction>0?this.leftOrigin.x:this.rightOrigin.x,o=this.stage.stageHeight/2+this.currentBlock.height;var i=this.currentBlock.x-n,a=this.currentBlock.y-o,s=this.player.x-i,c=this.player.y-a;this.updateAll(i,a),egret.Tween.get(this.player).to({x:s,y:c},800).call(function(){t.addBlock(),t.blockGroup.touchEnabled=!0})}else this.resetBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.reset,this),this.overGroup.visible=!0,this.overScoreLab.text=this.score.toString()},e.prototype.updateAll=function(t,e){egret.Tween.removeAllTweens();for(var r=this.blockArr.length-1;r>=0;r--){var n=this.blockArr[r];n.x+n.width-222<0||n.x-this.stage.stageWidth-222>0||n.y-this.stage.stageHeight-78>0?(n&&this.blockGroup.removeChild(n),this.blockArr.splice(r,1)):egret.Tween.get(n).to({x:n.x-t,y:n.y-e},800)}},e.prototype.reset=function(){this.score=0,this.scoreLab.text=this.score.toString(),this.blockGroup.removeChildren(),this.blockArr=[],this.initBlock(),this.blockGroup.touchEnabled=!0,this.overGroup.visible=!1},e.prototype.createBlock=function(){var t=Math.floor(Math.random()*this.blockSourceNames.length),e=new eui.Image;return e.source=this.blockSourceNames[t],this.blockGroup.addChildAt(e,1),e.anchorOffsetX=222,e.anchorOffsetY=78,e.touchEnabled=!1,this.blockArr.push(e),e},e.prototype.addBlock=function(){var t=this.createBlock(),e=this.minDistance+Math.random()*(this.maxDistance-this.minDistance);this.direction>0?(t.x=this.currentBlock.x+e,t.y=this.currentBlock.y-e*this.tanAngle):(t.x=this.currentBlock.x-e,t.y=this.currentBlock.y-e*this.tanAngle),this.currentBlock=t},e}(eui.Component);window.SceneGame=r,__reflect(r.prototype,"SceneGame",["eui.UIComponent"])}]);